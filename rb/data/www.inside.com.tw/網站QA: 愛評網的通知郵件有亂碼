


愛評網是國內知名的web 2.0網站，以提供各地消費資訊分享評分平台為主。是個相對成功的網站。
平常Inside團員要聚會的時候，我也會上到愛評網來進行搜尋，以決定要去哪間餐廳吃飯最理想。
剛在電子郵件信箱中收到來自愛評網的一則肉乾促銷訊息 - "快車肉乾感恩回饋！年節送禮最後一波超殺折扣～絕不追加"
我連上去看，絕不追加的肉乾已經賣完了，很熱。
郵件亂碼問題
不過，重點是這封電子郵件的寄件人與信件標題都出現了亂碼：
寄件人顯示：
iPeen ��蝬�
信件標題顯示：
想要飛嚗Peen 愛評網 – 您有一封新訊息：快車肉乾感恩回饋！年節送禮最後一波超殺折扣～絕不追加

細部QA
讓我們很快地來檢驗這個問題:
如果使用gmail作為收信夾就很容易看出端倪，打開郵件後點選右上方的"郵件文字變成亂碼？"
開出的新視窗中可以看到，剛剛亂碼的文字現在反而看到了，但是其他的文字則都變成了亂碼。
From: [email protected]
/* <![CDATA[ */
(function(){try{var s,a,i,j,r,c,l,b=document.getElementsByTagName("script");l=b[b.length-1].previousSibling;a=l.getAttribute('data-cfemail');if(a){s='';r=parseInt(a.substr(0,2),16);for(j=2;a.length-j;j+=2){c=parseInt(a.substr(j,2),16)^r;s+=String.fromCharCode(c);}s=document.createTextNode(s);l.parentNode.replaceChild(s,l);}}catch(e){}})();
/* ]]> */
 iPeen 愛評網
Subject: �Q�n��，iPeen �R��� �V �z���@�ʷs�T���G�֨��װ��P���^�X�I�~�`�e§�̫�@�i�W���馩�㵴���l�[

接著，將滑鼠移到瀏覽器的選單上面，用滑鼠選 檢視 -> 文字編碼，可以看到這個網頁目前是UTF-8編碼。

如果把它選擇成Big5編碼，則就可看到剛剛的情況 -- 大部分的文字都沒有問題，少部分出現亂碼。

所以？
從上述的情況來看，在兩種網頁的編碼方式中切換，就可以分別看到正確的文字。而兩種編碼方式可以看到的文字加起來剛好是全部的信件內容。
這說明了，該電子郵件使用了兩種不同的編碼進行內容的組成。
但是，我們看郵件時，電腦又只能用一種編碼來做顯示，所以造成了這種"顯示亂碼"的問題。
出錯原因
電腦上的文字根據編碼系統來顯示。
在這封愛評網的訊息通知信中，顯然將UTF8與Big5編碼的字串混和使用了。
估計是寫郵件樣板template的人用了UTF-8，套上Big5的訊息本文所以出了問題。
中文網站過去普遍使用Big5編碼，近年來已經逐步轉換，大部分的新網站都是使用UTF8萬國碼來編碼。
但這個歷史因素中，在郵件閱讀器上仍留有Big5的遺毒。如果使用UTF8來做中文電子郵件的編碼的話，有的老舊的電子郵件閱讀器甚至會誤判，導致整封email被視為亂碼呈現。
過去的經驗是Microsoft的outlook (express)與hotmail等不能有效判斷UTF8的中文信件。 這也是為什麼有的網站明明整個網站內容都已經是UTF8編碼了，但是在寄通知信上面會想辦法轉換成為Big5來編碼郵件寄出。
小結
愛評網的這封信在這個郵件編碼問題上栽了個小跟斗。
不過，問題很小，也好解決。
發出信件之前多做些測試，這個問題就不致於會發生。
其他網站服務也應引為借鏡。





